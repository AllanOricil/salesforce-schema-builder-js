!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.schemaBuilder=i():t.schemaBuilder=i()}(window,(function(){return function(t){var i={};function s(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=i,s.d=function(t,i,e){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)s.d(e,o,function(i){return t[i]}.bind(null,o));return e},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=2)}([function(t,i,s){window,t.exports=function(t){var i={};function s(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=i,s.d=function(t,i,e){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)s.d(e,o,function(i){return t[i]}.bind(null,o));return e},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=0)}([function(t,i,s){"use strict";s.r(i),s.d(i,"Canvas",(function(){return _})),s.d(i,"CanvasElement",(function(){return m})),s.d(i,"Circle",(function(){return E})),s.d(i,"Diamond",(function(){return x})),s.d(i,"Polygon",(function(){return w})),s.d(i,"Rectangle",(function(){return A})),s.d(i,"Shape",(function(){return v})),s.d(i,"Triangle",(function(){return C})),s.d(i,"Background",(function(){return y})),s.d(i,"Border",(function(){return p})),s.d(i,"Color",(function(){return g})),s.d(i,"Font",(function(){return P})),s.d(i,"Line",(function(){return L})),s.d(i,"Padding",(function(){return d})),s.d(i,"Shadow",(function(){return u})),s.d(i,"Dimension",(function(){return o})),s.d(i,"Position",(function(){return e})),s.d(i,"Rotation",(function(){return n})),s.d(i,"Scale",(function(){return r})),s.d(i,"Transform",(function(){return a})),s.d(i,"getTextHeight",(function(){return T})),s.d(i,"syntaxHighlight",(function(){return l})),s.d(i,"isMobile",(function(){return I})),s.d(i,"removeWhiteSpaces",(function(){return f})),s.d(i,"getBezierPoints",(function(){return D})),s.d(i,"getPathPointsGivenPath",(function(){return O}));class e{constructor({x:t,y:i}){this._x=t,this._y=i}get x(){return parseInt(this._x?this._x.toFixed(0):0)}get y(){return parseInt(this._y?this._y.toFixed(0):0)}}class o{constructor({width:t,height:i}){this._width=t,this._height=i}get width(){return this._width}get height(){return this._height}set width(t){this._width=t}set height(t){this._height=t}}class n{constructor({angle:t,referential:i}){this._angle=t,this._referential=new e(i||{x:0,y:0})}get angle(){return this._angle}}class r{constructor({horizontal:t,vertical:i}){this._horizontal=t,this._vertical=i}get horizontal(){return this._horizontal}get vertical(){return this._vertical}}class a{static get POSITION(){return new e({x:0,y:0})}static get DIMENSION(){return new o({width:0,height:0})}static get ROTATION(){return new n({angle:0})}static get SCALE(){return new r({horizontal:1,vertical:1})}constructor({position:t,dimension:i,rotation:s,scale:h}){this._position=t?new e(t):a.POSITION,this._dimension=i?new o(i):a.DIMENSION,this._rotation=s?new n(s):a.ROTATION,this._scale=h?new r(h):a.SCALE,this._oldPosition=new e(this._position),this._oldDimension=new o(this._dimension),this._oldRotation=new n(this._rotation),this._oldScale=new r(this._scale)}set position({x:t,y:i}){this._oldPosition._x=Math.floor(this._position._x),this._oldPosition._y=Math.floor(this._position._y),this._position._x=Math.floor(t),this._position._y=Math.floor(i)}set dimension({width:t,height:i}){this._oldDimension.width=Math.floor(this._dimension._width),this._oldDimension.height=Math.floor(this._dimension._height),this._dimension.width=Math.floor(t),this._dimension.height=Math.floor(i)}set rotation({angle:t}){this._oldRotation._angle=Math.floor(this._rotation._angle),this._rotation._angle=Math.floor(t)}set scale({horizontal:t,vertical:i}){this._oldScale._horizontal=Math.floor(this._scale._horizontal),this._oldScale._vertical=Math.floor(this._scale._vertical),this._scale._horizontal=Math.floor(t),this._scale._vertical=Math.floor(i)}get oldTransform(){return{position:this._oldPosition,dimension:this._oldDimension,rotation:this._oldRotation,scale:this._oldScale}}}class h{constructor(){this._canvasElementMap=new Map,[...Array(100).keys()].forEach(t=>{this._canvasElementMap.set(t,new Map)}),this._canvasElementLayerMap=new Map,this._canvasElementsToDraw=[],this._reactiveCanvasElements=[]}getLayer(t){return this._canvasElementMap.get(t)}getCanvasElementLayerByName(t){return this.getLayer(this._canvasElementLayerMap.get(t))}getCanvasElementByName(t){const i=this.getCanvasElementLayerByName(t);return i?i.get(t):null}addCanvasElement(t){this.getLayer(t._z||0).set(t._name,t),this._canvasElementLayerMap.set(t._name,t._z),this._setReactiveAndToDrawCanvasElements()}removeCanvasElementByName(t){return this.getCanvasElementLayerByName(t).delete(t)}clearLayer(t){const i=this.getLayer(t);i&&i.clear()}getCanvasElementsInLayer(t){return this.getLayer(t).values()}moveCanvasElementToLayer(t,i){this.removeCanvasElementByName(t._name),t._z=i,this.addCanvasElement(t),this._setReactiveAndToDrawCanvasElements()}_setReactiveAndToDrawCanvasElements(){this._reactiveCanvasElements=[],this._canvasElementsToDraw=[];for(let[t,i]of this._canvasElementMap.entries())i.forEach(t=>{t._draw&&this._canvasElementsToDraw.push(t),t._reactToIoEvents&&this._reactiveCanvasElements.push(t)})}}class _{static get SCALE(){return{horizontal:1,vertical:1}}static get SCALELIMITS(){return{max:2,min:.2,speed:.01}}static get FPS(){return 60}static get CANDRAGCANVAS(){return!0}constructor({options:t,canvas:i}){this._canvasElementsManager=new h,this._dpi=window.devicePixelRatio,this._el=i||document.getElementById("canvas"),this._el.style.maxHeight="none",this._el.focus(),this._el.setAttribute("tabindex",1),this._imagesSource=t.imagesSource,this._el.style.backgroundImage=t.backgroundImage,this._el.style.backgroundColor=t.background&&t.background.color?t.background.color:null,this._fps=t.fps?t.fps:_.FPS,this._canMoveCanvasElements=!1!==t.canMoveCanvasElements,this._canDragCanvas=!1!==t.canDragCanvas,this._mouse=new e({x:0,y:0}),this._scaleLimits=t.zoom?{max:t.zoom.max||_.SCALELIMITS.max,min:t.zoom.min||_.SCALELIMITS.min,speed:t.zoom.speed||_.SCALELIMITS.speed}:_.SCALELIMITS,this._transform=new a({position:{x:0,y:0},dimension:{width:this._el.parentElement.clientWidth,height:this._el.parentElement.clientHeight},scale:{horizontal:t.zoom.level,vertical:t.zoom.level}}),this._el.width=this._el.parentElement.clientWidth,this._el.height=this._el.parentElement.clientHeight,this._el.setAttribute("width",this._el.parentElement.clientWidth),this._el.setAttribute("height",this._el.parentElement.clientHeight),"undefined"!=typeof OffscreenCanvas?("OffscreenCanvas"in window?this._offscreenCanvas=this._el.transferControlToOffscreen():this._offscreenCanvas=new OffscreenCanvas(this._transform._dimension.width,this._transform._dimension.height),this._ctx=this._offscreenCanvas.getContext("2d")):this._ctx=this._el.getContext("2d"),this._isSelecting=!1,this._selectionStartPosition=void 0,this._selectionWidth=void 0,this._selectionHeight=void 0;let s=!1,o=!1,n=void 0,r=void 0,l=void 0,d=!1,c=[],m=null,f=!1,g=null;this._el.addEventListener("mousedown",t=>{this._canMoveCanvasElements&&o?(this._isSelecting=!0,this._selectionStartPosition=this.getTransformedPoint(t.offsetX,t.offsetY),this._el.style.cursor="default"):g?(g.emit("mousedown",t),this._isCurrentFrameDirty=!0,this._canMoveCanvasElements&&!m&&g._isDraggable&&(m=g,r=this.getTransformedPoint(t.offsetX,t.offsetY))):c.length>0?(c.forEach(t=>t.emit("deselect")),c=[],s=!1,this._isCurrentFrameDirty=!0):this._canDragCanvas&&(n=this.getTransformedPoint(t.offsetX,t.offsetY),d=!0)});let p=Date.now();this._el.addEventListener("mousemove",t=>{if(Date.now()-p>=12){if(this._mouse._x=t.offsetX,this._mouse._y=t.offsetY,l=this.getTransformedPoint(t.offsetX,t.offsetY),this._isSelecting){c=[],this._selectionEndPosition=l,this._selectionWidth=this._selectionEndPosition.x-this._selectionStartPosition.x,this._selectionHeight=this._selectionEndPosition.y-this._selectionStartPosition.y;let t=this._selectionStartPosition.x,i=this._selectionStartPosition.y,s=this._selectionEndPosition.x,e=this._selectionEndPosition.y;if(this._selectionWidth<0){const i=t;t=s,s=i}if(this._selectionHeight<0){const t=i;i=e,e=t}for(let o=this._canvasElementsManager._reactiveCanvasElements.length-1;o>=0;o--){let n=this._canvasElementsManager._reactiveCanvasElements[o];n._transform._position.x>s||n._transform._position.x+n._transform._dimension.width<t||n._transform._position.y>e||n._transform._position.y+n._transform._dimension.height<i?n.emit("deselect"):(n.emit("select"),c.push(n))}this._isCurrentFrameDirty=!0}else{if(d)this._el.style.cursor="grabbing",this._ctx.translate(Math.floor(l.x-n.x),Math.floor(l.y-n.y)),this._isCurrentFrameDirty=!0;else if(m){f=!0;const i=Math.floor(l.x-r.x),s=Math.floor(l.y-r.y);c.length>0?c.forEach(t=>{t.emit("mousedrag",{deltaX:i,deltaY:s})}):m.emit("mousedrag",{deltaX:i,deltaY:s}),this._isCurrentFrameDirty=!0,r=this.getTransformedPoint(t.offsetX,t.offsetY)}else if(g&&g.contains(this._mouse))g.emit("mousemove",this._mouse),this._isCurrentFrameDirty=!0;else{g&&(g.emit("mouseleave",this._mouse),g=null),this._el.style.cursor="default";for(let t=this._canvasElementsManager._reactiveCanvasElements.length-1;t>=0;t--){let i=this._canvasElementsManager._reactiveCanvasElements[t];if(i.contains(this._mouse)){this._el.style.cursor="grabbing",g=i,i.emit("mouseenter",this._mouse);break}}this._isCurrentFrameDirty=!0}n=this.getTransformedPoint(t.offsetX,t.offsetY)}p=Date.now()}}),this._el.addEventListener("mouseup",t=>{this._isSelecting?(this._isSelecting=!1,this._selectionWidth=void 0,this._selectionHeight=void 0):(m&&(m.emit("mouseup",t),m=null),d=!1)}),this._el.addEventListener("click",t=>{f?f=!1:g&&(g.emit("click"),this._el.dispatchEvent(g.createEvent("clickentity")),this._isCurrentFrameDirty=!0)}),this._el.addEventListener("mouseout",t=>{d=!1,c=[],m=null,f=!1}),this._el.addEventListener("wheel",t=>{if(Date.now()-p>=12){l=this.getTransformedPoint(t.offsetX,t.offsetY);const i=t.wheelDelta>0||t.deltaY<0?1+this._scaleLimits.speed:1-this._scaleLimits.speed,s=this._ctx.getTransform().a*i;g?g.emit("wheel",t):s>this._scaleLimits.min&&s<this._scaleLimits.max&&(this._ctx.translate(l.x,l.y),this._ctx.scale(i,i),this._ctx.translate(-l.x,-l.y),this._isCurrentFrameDirty=!0),p=Date.now(),this._isCurrentFrameDirty=!0}},{passive:!0}),this._el.addEventListener("keydown",t=>{o=t.ctrlKey}),this._el.addEventListener("keyup",t=>{o=t.ctrlKey}),this._el.addEventListener("focusout",()=>{this._isSelecting=!1,c.forEach(t=>t.emit("deselect")),c=[]});let u=null;this._el.addEventListener("touchstart",t=>{if(1===t.touches.length){this._mouse._x=t.touches[0].clientX,this._mouse._y=t.touches[0].clientY;for(let t=this._canvasElementsManager.canvasElements.length-1;t>=0;t--){let i=this._canvasElementsManager.canvasElements[t];if(i.contains(this._mouse))return g=i,m||(m=i),void this._el.dispatchEvent(i.createEvent("touchstartentity"))}d=!0,u&&(t.timeStamp,u.timeStamp,t.timeStamp-u.timeStamp<=200&&this._el.dispatchEvent(new CustomEvent("dbtouch",t))),u=t}},{passive:!0});let b=null;this._el.addEventListener("touchmove",t=>{if(1===t.touches.length){if(this._mouse._x=t.touches[0].clientX,this._mouse._y=t.touches[0].clientY,l=this.getTransformedPoint(this._mouse._x,this._mouse._y),d&&b){let t=this.getTransformedPoint(b.touches[0].clientX,b.touches[0].clientY);this._ctx.translate(l.x-t.x,l.y-t.y)}else m&&(f=!0,m.position={x:l.x-m._transform._dimension.width/2,y:l.y-m._transform._dimension.height/2});b=t}},{passive:!0}),this._el.addEventListener("touchend",t=>{m&&(m=null),d=!1,b=null},{passive:!0}),this._evCache=[],this.prevDiff=-1;const y=t=>{v(t),this._evCache.length<2&&(this.prevDiff=-1)},v=t=>{for(var i=0;i<this._evCache.length;i++)if(this._evCache[i].pointerId==t.pointerId){this._evCache.splice(i,1);break}};this._el.onpointerdown=t=>{this._evCache.push(t)},this._el.onpointermove=t=>{for(var i=0;i<this._evCache.length;i++)if(t.pointerId==this._evCache[i].pointerId){this._evCache[i]=t;break}if(2==this._evCache.length){var s=Math.abs(this._evCache[0].clientX-this._evCache[1].clientX);const t=(this._evCache[0].clientX+this._evCache[1].clientX)/2,i=(this._evCache[0].clientY+this._evCache[1].clientY)/2,e=this.getTransformedPoint(t,i);if(this.prevDiff>0){const t=s>this.prevDiff<0?1+this._scaleLimits.speed:1-this._scaleLimits.speed,i=this._ctx.getTransform().a*t;i>this._scaleLimits.min&&i<this._scaleLimits.max&&(this._ctx.translate(e.x,e.y),this._ctx.scale(t,t),this._ctx.translate(-e.x,-e.y))}this.prevDiff=s}},this._el.onpointerup=y,this._el.onpointercancel=y,this._el.onpointerout=y,this._el.onpointerleave=y,window.onresize=t=>{this._transform._dimension.width=this._el.parentElement.clientWidth,this._transform._dimension.height=this._el.parentElement.clientHeight,this._offscreenCanvas?(this._offscreenCanvas.width=this._transform._dimension.width,this._offscreenCanvas.height=this._transform._dimension.height):(this._el.width=this._transform._dimension.width,this._el.height=this._transform._dimension.height),this._isCurrentFrameDirty=!0},this._isCurrentFrameDirty=!0,this.start()}start(){setInterval(()=>{this._isCurrentFrameDirty&&(this.draw(),this._isCurrentFrameDirty=!1)},1e3/this._fps),this.draw()}draw(){this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._el.width,this._el.height),this._ctx.restore();const t=this._canvasElementsManager._canvasElementsToDraw;for(let i=0;i<t.length;i++)t[i].draw(this._ctx);this._isSelecting&&(this._ctx.save(),this._ctx.lineWidth=3,this._ctx.setLineDash([5,5]),this._ctx.strokeStyle="rgba(0,0,255,0.3)",this._ctx.fillStyle="rgba(0,0,255,0.02)",this._ctx.fillRect(this._selectionStartPosition.x,this._selectionStartPosition.y,this._selectionWidth,this._selectionHeight),this._ctx.strokeRect(this._selectionStartPosition.x,this._selectionStartPosition.y,this._selectionWidth,this._selectionHeight),this._ctx.restore())}getTransformedPoint(t,i){const s=this._ctx.getTransform(),e=1/s.a;return{x:e*t-e*s.e,y:e*i-e*s.f}}saveAsImage(t){var i=document.createElement("a");i.download=t+".png",i.href=this._el.toDataURL("image/png").replace("image/png","image/octet-stream"),i.click()}saveAsImage2(t){const i=document.createElement("canvas");i.width=10*this._el.width,i.height=10*this._el.height;const s=i.getContext("2d"),e=this._ctx.getTransform();this._ctx.setTransform(1,0,0,1,0,0),s.drawImage(this._el,0,0),this._ctx.setTransform(e);const o=document.createElement("a");o.download="canvas.png",o.href=i.toDataURL("image/png").replace("image/png","image/octet-stream"),o.click()}}const l=function(t){return"string"!=typeof t&&(t=JSON.stringify(t,void 0,2)),(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,(function(t){var i="number";return/^"/.test(t)?i=/:$/.test(t)?"key":"string":/true|false/.test(t)?i="boolean":/null/.test(t)&&(i="null"),'<span class="'+i+'">'+t+"</span>"}))};class d{static get NONE(){return new d({top:0,left:0,right:0,bottom:0})}constructor({top:t,right:i,bottom:s,left:e}){this._top=t,this._right=i,this._bottom=s,this._left=e}}class c{constructor(){this.callbacks={}}on(t,i){this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(i)}emit(t,i){let s=this.callbacks[t];s&&s.forEach(t=>{t(i)})}}class m{constructor({name:t,padding:i,dimension:s,position:e,rotation:o,parent:n,nonReactiveToIO:r},h){if(!t)throw new Error("Every Canvas Element must have a name.");this._eventEmitter=new c,this._id=+new Date+1e5*Math.random(),this._name=t,this._selected=!1,this._hover=!1,this._transform=new a({position:e||void 0,dimension:s||void 0,rotation:o||void 0}),this._padding=i?new d(i):d.NONE,this._parent=n||void 0,this._children=[],this._canvas=h||void 0,this._draw=!0,this._reactToIoEvents=!1!==r}createEvent(t){return new CustomEvent(t,{detail:this})}contains(t){return!(!this._shape||!this._shape._path)&&this._canvas._ctx.isPointInPath(this._shape._path,t.x,t.y,"nonzero")}toString(){return{id:this._id,name:this._name}}prettier(){return l(this.toString())}on(t,i){this._eventEmitter.on(t,i)}emit(t,i){this._eventEmitter.emit(t,i)}set position({x:t,y:i}){this._transform.position={x:t,y:i},this._shape&&(this._shape._transform.position={x:t,y:i})}}const f=t=>t.replace(/\s/g,"");class g{static get htmlColors(){return{INDIANRED:"rgb(205, 92, 92)",LIGHTCORAL:"rgb(240, 128, 128)",SALMON:"rgb(250, 128, 114)",DARKSALMON:"rgb(233, 150, 122)",LIGHTSALMON:"rgb(255, 160, 122)",CRIMSON:"rgb(220, 20, 60)",RED:"rgb(255, 0, 0)",FIREBRICK:"rgb(178, 34, 34)",DARKRED:"rgb(139, 0, 0)",PINK:"rgb(255, 192, 203)",LIGHTPINK:"rgb(255, 182, 193)",HOTPINK:"rgb(255, 105, 180)",DEEPPINK:"rgb(255, 20, 147)",MEDIUMVIOLETRED:"rgb(199, 21, 133)",PALEVIOLETRED:"rgb(219, 112, 147)",LIGHTSALMON:"rgb(255, 160, 122)",CORAL:"rgb(255, 127, 80)",TOMATO:"rgb(255, 99, 71)",ORANGERED:"rgb(255, 69, 0)",DARKORANGE:"rgb(255, 140, 0)",ORANGE:"rgb(255, 165, 0)",GOLD:"rgb(255, 215, 0)",YELLOW:"rgb(255, 255, 0)",LIGHTYELLOW:"rgb(255, 255, 224)",LEMONCHIFFON:"rgb(255, 250, 205)",LIGHTGOLDENRODYELLOW:"rgb(250, 250, 210)",PAPAYAWHIP:"rgb(255, 239, 213)",MOCCASIN:"rgb(255, 228, 181)",PEACHPUFF:"rgb(255, 218, 185)",PALEGOLDENROD:"rgb(238, 232, 170)",KHAKI:"rgb(240, 230, 140)",DARKKHAKI:"rgb(189, 183, 107)",LAVENDER:"rgb(230, 230, 250)",THISTLE:"rgb(216, 191, 216)",PLUM:"rgb(221, 160, 221)",VIOLET:"rgb(238, 130, 238)",ORCHID:"rgb(218, 112, 214)",FUCHSIA:"rgb(255, 0, 255)",MAGENTA:"rgb(255, 0, 255)",MEDIUMORCHID:"rgb(186, 85, 211)",MEDIUMPURPLE:"rgb(147, 112, 219)",REBECCAPURPLE:"rgb(102, 51, 153)",BLUEVIOLET:"rgb(138, 43, 226)",DARKVIOLET:"rgb(148, 0, 211)",DARKORCHID:"rgb(153, 50, 204)",DARKMAGENTA:"rgb(139, 0, 139)",PURPLE:"rgb(128, 0, 128)",INDIGO:"rgb(75, 0, 130)",SLATEBLUE:"rgb(106, 90, 205)",DARKSLATEBLUE:"rgb(72, 61, 139)",MEDIUMSLATEBLUE:"rgb(123, 104, 238)",GREENYELLOW:"rgb(173, 255, 47)",CHARTREUSE:"rgb(127, 255, 0)",LAWNGREEN:"rgb(124, 252, 0)",LIME:"rgb(0, 255, 0)",LIMEGREEN:"rgb(50, 205, 50)",PALEGREEN:"rgb(152, 251, 152)",LIGHTGREEN:"rgb(144, 238, 144)",MEDIUMSPRINGGREEN:"rgb(0, 250, 154)",SPRINGGREEN:"rgb(0, 255, 127)",MEDIUMSEAGREEN:"rgb(60, 179, 113)",SEAGREEN:"rgb(46, 139, 87)",FORESTGREEN:"rgb(34, 139, 34)",GREEN:"rgb(0, 128, 0)",DARKGREEN:"rgb(0, 100, 0)",YELLOWGREEN:"rgb(154, 205, 50)",OLIVEDRAB:"rgb(107, 142, 35)",OLIVE:"rgb(128, 128, 0)",DARKOLIVEGREEN:"rgb(85, 107, 47)",MEDIUMAQUAMARINE:"rgb(102, 205, 170)",DARKSEAGREEN:"rgb(143, 188, 139)",LIGHTSEAGREEN:"rgb(32, 178, 170)",DARKCYAN:"rgb(0, 139, 139)",TEAL:"rgb(0, 128, 128)",AQUA:"rgb(0, 255, 255)",CYAN:"rgb(0, 255, 255)",LIGHTCYAN:"rgb(224, 255, 255)",PALETURQUOISE:"rgb(175, 238, 238)",AQUAMARINE:"rgb(127, 255, 212)",TURQUOISE:"rgb(64, 224, 208)",MEDIUMTURQUOISE:"rgb(72, 209, 204)",DARKTURQUOISE:"rgb(0, 206, 209)",CADETBLUE:"rgb(95, 158, 160)",STEELBLUE:"rgb(70, 130, 180)",LIGHTSTEELBLUE:"rgb(176, 196, 222)",POWDERBLUE:"rgb(176, 224, 230)",LIGHTBLUE:"rgb(173, 216, 230)",SKYBLUE:"rgb(135, 206, 235)",LIGHTSKYBLUE:"rgb(135, 206, 250)",DEEPSKYBLUE:"rgb(0, 191, 255)",DODGERBLUE:"rgb(30, 144, 255)",CORNFLOWERBLUE:"rgb(100, 149, 237)",MEDIUMSLATEBLUE:"rgb(123, 104, 238)",ROYALBLUE:"rgb(65, 105, 225)",BLUE:"rgb(0, 0, 255)",MEDIUMBLUE:"rgb(0, 0, 205)",DARKBLUE:"rgb(0, 0, 139)",NAVY:"rgb(0, 0, 128)",MIDNIGHTBLUE:"rgb(25, 25, 112)",CORNSILK:"rgb(255, 248, 220)",BLANCHEDALMOND:"rgb(255, 235, 205)",BISQUE:"rgb(255, 228, 196)",NAVAJOWHITE:"rgb(255, 222, 173)",WHEAT:"rgb(245, 222, 179)",BURLYWOOD:"rgb(222, 184, 135)",TAN:"rgb(210, 180, 140)",ROSYBROWN:"rgb(188, 143, 143)",SANDYBROWN:"rgb(244, 164, 96)",GOLDENROD:"rgb(218, 165, 32)",DARKGOLDENROD:"rgb(184, 134, 11)",PERU:"rgb(205, 133, 63)",CHOCOLATE:"rgb(210, 105, 30)",SADDLEBROWN:"rgb(139, 69, 19)",SIENNA:"rgb(160, 82, 45)",BROWN:"rgb(165, 42, 42)",MAROON:"rgb(128, 0, 0)",WHITE:"rgb(255, 255, 255)",SNOW:"rgb(255, 250, 250)",HONEYDEW:"rgb(240, 255, 240)",MINTCREAM:"rgb(245, 255, 250)",AZURE:"rgb(240, 255, 255)",ALICEBLUE:"rgb(240, 248, 255)",GHOSTWHITE:"rgb(248, 248, 255)",WHITESMOKE:"rgb(245, 245, 245)",SEASHELL:"rgb(255, 245, 238)",BEIGE:"rgb(245, 245, 220)",OLDLACE:"rgb(253, 245, 230)",FLORALWHITE:"rgb(255, 250, 240)",IVORY:"rgb(255, 255, 240)",ANTIQUEWHITE:"rgb(250, 235, 215)",LINEN:"rgb(250, 240, 230)",LAVENDERBLUSH:"rgb(255, 240, 245)",MISTYROSE:"rgb(255, 228, 225)",GAINSBORO:"rgb(220, 220, 220)",LIGHTGRAY:"rgb(211, 211, 211)",SILVER:"rgb(192, 192, 192)",DARKGRAY:"rgb(169, 169, 169)",GRAY:"rgb(128, 128, 128)",DIMGRAY:"rgb(105, 105, 105)",LIGHTSLATEGRAY:"rgb(119, 136, 153)",SLATEGRAY:"rgb(112, 128, 144)",DARKSLATEGRAY:"rgb(47, 79, 79)",BLACK:"rgb(0, 0, 0)"}}static isRGB(t){return null!==t.match(/^rgb\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3}\)$/gi)}static isRGBA(t){return null!==t.match(/^(rgba\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*,\s*([0|1].?\d*)\s*\))$/gi)}static isHEX(t){return null!==t.match(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/gi)}static string2Color(t){const i=g.htmlColors[t.toUpperCase()];if(i&&(t=i),t=f(t),g.isRGB(t)||g.isRGBA(t)){let i=t.replace("rgb(","").replace("rgba(","").replace(")","").split(",");return{red:i[0],green:i[1],blue:i[2],alpha:i[3]||1}}if(g.isHEX(t)){const i=(t=t.replace("#","")).length/3;return{red:parseInt(t.substring(0,i),16),green:parseInt(t.substring(i,2*i),16),blue:parseInt(t.substring(2*i,3*i),16),alpha:1}}throw new Error(`The color ${t} is not a valid rgb, rgba or hex color.`)}static rgbToHex(t){if(!g.isRGB(t)&&!g.isRGBA(t))throw new Error(`The color ${t} is not a valid rgb or rgba color.`);const i=(t=t.replace(/\s/g,"")).replace("rgb(","").replace("rgba(","").replace(")","").split(",");let s="#";return i.forEach((t,i)=>{if(3!=i){const i=Number(t).toString(16);s+=2===i.length?i:"0"+i}}),s}constructor(t){"string"==typeof t&&(t=g.string2Color(t)),this._red=t.red,this._green=t.green,this._blue=t.blue,this._alpha=t.alpha||1}get rgb(){return`rgb(${this._red},${this._green},${this._blue})`}get rgba(){return`rgba(${this._red},${this._green},${this._blue},${this._alpha})`}get hex(){return g.rgbToHex(this.rgb)}set color(t){"string"==typeof t&&(t=g.string2Color(t)),this._red=t.red,this._green=t.green,this._blue=t.blue,this._alpha=t.alpha||1}}class p{static get SMALL(){return new p({radius:0,lineWidth:1})}constructor({radius:t,color:i,lineWidth:s,selected:e,hover:o}){this._radius=t||0,this._lineWidth=s||0,this._color=i?new g(i):null,this._selected=e?new p({lineWidth:e.lineWidth,color:e.color}):null,this._hover=o?new p({lineWidth:o.lineWidth,color:o.color}):null}set color(t){this._color=new g(t)}}class u{constructor({offsetX:t,offsetY:i,color:s,blur:e}){this._offsetX=t,this._offsetY=i,this._color=new g(s),this._blur=e}set color(t){this._color=new g(t)}}class b{constructor({src:t,position:i,dimension:s,rotation:e,scale:o}){this._transform=new a({position:i,dimension:s,rotation:e,scale:o}),this._image=s?new Image(this._transform._dimension.width,this._transform._dimension.height):new Image,this._src=t,this._image.src=this._src,this._image.addEventListener("load",()=>{this._loaded=!0}),this._loaded=!1}set src(t){this._src=t,this._loaded=!1}draw(t){this._transform._dimension?t.drawImage(this._image,this._transform._position.x,this._transform._position.y,this._transform._dimension.width,this._transform._dimension.height):t.drawImage(this._image,this._transform._position.x,this._transform._position.y)}}class y{static get WHITE(){return new y({color:"white"})}static get TRANSPARENT(){return new y({color:"rgba(255,255,255,0)"})}constructor({color:t,image:i}){this._color=t?new g(t):null,this._image=i?new b({image:i}):null}set color(t){this._color=new g(t)}set Image(t){this._image=new b(t)}}class v{static get ROTATION(){return new Rotation({angle:0})}static get SHADOW(){return new u({offsetX:0,offsetY:0,color:"rgb(0,0,0)",blur:0})}constructor({position:t,dimension:i,rotation:s,scale:e,background:o,border:n,shadow:r}){this._transform=new a({position:t,dimension:i,rotation:s,scale:e}),this._border=n?new p(n):p.SMALL,this._background=o?new y(o):y.TRANSPARENT,this._shadow=r?new u(r):null,this._path=null}draw(t){this._shadow&&(t.shadowColor=this._shadow._color.rgba,t.shadowBlur=this._shadow.blur,t.shadowOffsetX=this._shadow.offsetX,t.shadowOffsetY=this._shadow.offsetY),this._border&&this._border._color&&(t.strokeStyle=this._border._color.rgba),this._border&&this._border.lineWidth&&(t.lineWidth=this._border.lineWidth),this._background&&this._background._color&&(t.fillStyle=this._background._color.rgba)}get sides(){const t=this._transform._dimension.width/2,i=this._transform._dimension.height/2;return{top:{x:this._transform._position.x+t,y:this._transform._position.y},right:{x:this._transform._position.x+this._transform._dimension.width,y:this._transform._position.y+i},bottom:{x:this._transform._position.x+t,y:this._transform._position.y+this._transform._dimension.height},left:{x:this._transform._position.x,y:this._transform._position.y+i}}}get rotate(){return this._transform._rotation&&this._transform._rotation.angle>0}}class E extends v{constructor({position:t,rotation:i,border:s,background:e,diameter:o,shadow:n}){super({position:t,rotation:i,border:s,background:e,shadow:n}),this._diameter=o||0}draw(t){t.save(),super.draw(t),this.rotate&&(t.translate(this._transform._position.x,this._transform._position.y),t.rotate(this._transform._rotation.angle),t.translate(-this._transform._position.x,-this._transform._position.y)),t.beginPath(),this._path=new Path2D,this._path.arc(this._transform._position.x,this._transform._position.y,this._diameter,0,2*Math.PI),this._path.closePath(),t.stroke(this._path),t.fill(this._path),t.shadowColor=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.stroke(this._path),t.restore()}}class x extends v{constructor({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n}){super({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n})}draw(t){if(t.save(),super.draw(t),this.rotate){const i=this._transform._position.x+this._transform._dimension.width/2,s=this._transform._position.y+this._transform._dimension.height/2;t.translate(i,s),t.rotate(this._transform._rotation.angle),t.translate(-i,-s)}this._path=new Path2D,t.beginPath(),this._path.moveTo(this.sides.top.x-this._border.radius,this.sides.top.y+this._border.radius),this._path.quadraticCurveTo(this.sides.top.x,this.sides.top.y+.5*this._border.radius,this.sides.top.x+this._border.radius,this.sides.top.y+this._border.radius),this._path.lineTo(this.sides.right.x-this._border.radius,this.sides.right.y-this._border.radius),this._path.quadraticCurveTo(this.sides.right.x,this.sides.right.y,this.sides.right.x-this._border.radius,this.sides.right.y+this._border.radius),this._path.lineTo(this.sides.bottom.x+this._border.radius,this.sides.bottom.y-this._border.radius),this._path.quadraticCurveTo(this.sides.bottom.x,this.sides.bottom.y-.5*this._border.radius,this.sides.bottom.x-this._border.radius,this.sides.bottom.y-this._border.radius),this._path.lineTo(this.sides.left.x+this._border.radius,this.sides.left.y+this._border.radius),this._path.quadraticCurveTo(this.sides.left.x,this.sides.left.y,this.sides.left.x+this._border.radius,this.sides.left.y-this._border.radius),this._path.lineTo(this.sides.top.x-this._border.radius,this.sides.top.y+this._border.radius),this._path.closePath(),t.stroke(this._path),t.fill(this._path),t.shadowColor=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.stroke(this._path),t.restore()}}class w extends v{constructor({points:t,position:i,dimension:s,rotation:e,border:o,background:n,shadow:r}){super({position:i,dimension:s,rotation:e,border:o,background:n,shadow:r}),this._points=t||[]}draw(t){if(t.save(),super.draw(t),this.rotate){const i=this._transform._position.x+this._transform._dimension.width/2,s=this._transform._position.y+this._transform._dimension.height/2;t.translate(i,s),t.rotate(this._transform._rotation.angle),t.translate(-i,-s)}this._path=new Path2D,t.beginPath(),this._path.moveTo(points[0].x,points[0].y),points.forEach(t=>{this._path.lineTo(t.x,t.y)}),this._path.closePath(),t.stroke(this._path),t.fill(this._path),t.shadowColor=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.stroke(this._path),t.restore()}}class A extends v{constructor({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n}){super({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n})}draw(t){if(t.save(),super.draw(t),this.rotate){const i=this._transform._position.x+this._transform._dimension.width/2,s=this._transform._position.y+this._transform._dimension.height/2;t.translate(i,s),t.rotate(this._transform._rotation.angle),t.translate(-i,-s)}this._path=new Path2D;var i=this._transform._position.x+this._transform._dimension.width,s=this._transform._position.y+this._transform._dimension.height;t.beginPath(),"object"==typeof this._border._radius?(this._path.moveTo(this._transform._position.x+this._border._radius.topLeft,this._transform._position.y),this._path.lineTo(i-this._border._radius.topRight,this._transform._position.y),this._path.quadraticCurveTo(i,this._transform._position.y,i,this._transform._position.y+this._border._radius.topRight),this._path.lineTo(i,this._transform._position.y+this._transform._dimension.height-this._border._radius.bottomRight),this._path.quadraticCurveTo(i,s,i-this._border._radius.bottomRight,s),this._path.lineTo(this._transform._position.x+this._border._radius.bottomLeft,s),this._path.quadraticCurveTo(this._transform._position.x,s,this._transform._position.x,s-this._border._radius.bottomLeft),this._path.lineTo(this._transform._position.x,this._transform._position.y+this._border._radius.topLeft),this._path.quadraticCurveTo(this._transform._position.x,this._transform._position.y,this._transform._position.x+this._border._radius.topLeft,this._transform._position.y)):(this._path.moveTo(this._transform._position.x+this._border._radius,this._transform._position.y),this._path.lineTo(i-this._border._radius,this._transform._position.y),this._path.quadraticCurveTo(i,this._transform._position.y,i,this._transform._position.y+this._border._radius),this._path.lineTo(i,this._transform._position.y+this._transform._dimension.height-this._border._radius),this._path.quadraticCurveTo(i,s,i-this._border._radius,s),this._path.lineTo(this._transform._position.x+this._border._radius,s),this._path.quadraticCurveTo(this._transform._position.x,s,this._transform._position.x,s-this._border._radius),this._path.lineTo(this._transform._position.x,this._transform._position.y+this._border._radius),this._path.quadraticCurveTo(this._transform._position.x,this._transform._position.y,this._transform._position.x+this._border._radius,this._transform._position.y)),this._path.closePath(),this._border&&this._border._color&&t.stroke(this._path),this._background&&this._background._color&&t.fill(this._path),t.shadowColor=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,this._border&&this._border._color&&t.stroke(this._path),t.restore()}get area(){return this._transform._dimension.width*this._transform._dimension.height}get center(){return{x:this._transform._position.x+this._transform._dimension.width/2,y:this._transform._position.y+this._transform._dimension.height/2}}}class C extends v{constructor({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n}){super({position:t,dimension:i,rotation:s,border:e,background:o,shadow:n})}draw(t){t.save(),super.draw(t),this.rotate&&(t.translate(this._transform._position.x,this._transform._position.y),t.rotate(this._transform._rotation.angle),t.translate(-this._transform._position.x,-this._transform._position.y)),this._path=new Path2D,t.beginPath(),this._path.moveTo(this._transform._position.x,this._transform._position.y),this._path.lineTo(this._transform._position.x-this._transform._dimension.width,this._transform._position.y-this._transform._dimension.height/2),this._path.lineTo(this._transform._position.x-this._transform._dimension.width,this._transform._position.y+this._transform._dimension.height/2),this._path.closePath(),t.stroke(this._path),t.fill(this._path),t.shadowColor=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.stroke(this._path),t.restore()}}const T=function({fontFamily:t,fontSize:i,fontWeight:s,element:e}){const o=e||document.body;var n=document.createElement("span");n.innerHTML="Hg",n.setAttribute("style",`font-family: ${t} !important; font-size: ${i}px !important; font-weight:${s} !important;`);var r=document.createElement("div");r.style.display="inline-block",r.style.width="1px",r.style.height="0px";var a=document.createElement("div");a.appendChild(n),a.appendChild(r),o.appendChild(a);try{var h={};r.style.verticalAlign="baseline",h.ascent=r.offsetTop-n.offsetTop,r.style.verticalAlign="bottom",h.height=r.offsetTop-n.offsetTop,h.descent=h.height-h.ascent}finally{a.remove()}return h};class P{static get ARIAL(){return new P({family:"Arial",style:"normal",variant:"normal",color:"black",size:15,weight:"normal"})}constructor({family:t,style:i,variant:s,color:e,size:o,weight:n}){this._family=t,this._style=i,this._variant=s,this._color=new g(e),this._size=o,this._weight=n,this._setFontDimensions()}set family(t){this._family=t,this._setFontDimensions()}set fontSize(t){this._fontSize=t,this._setFontDimensions()}set fontWeight(t){this._fontSize=t,this._setFontDimensions()}get font2Canvas(){return`${this._style||""} ${this._variant||""} ${this._weight||""} ${this._size?this._size+"px":""} ${this._family||""}`}set color(t){this._color=new g(t)}_setFontDimensions(){this._dimensions=T({fontFamily:this._family,fontSize:this._size,fontWeight:this._weight})}}class L{constructor({weight:t,color:i,enableBezierCurves:s,dashed:e,lineCap:o}){this._weight=t,this._color=new g(i),this._enableBezierCurves=s,this._dashed=e,this._lineCap=o||"round"}}const I=()=>/Mobi|Android/i.test(navigator.userAgent),S=function(t,i,s,e,o,n,r,a,h){return{x:Math.pow(1-t,3)*i+3*t*Math.pow(1-t,2)*e+3*t*t*(1-t)*n+t*t*t*a,y:Math.pow(1-t,3)*s+3*t*Math.pow(1-t,2)*o+3*t*t*(1-t)*r+t*t*t*h}},R=function(t,i,s,e,o,n,r){return{x:(1-t)*(1-t)*i+2*(1-t)*t*e+t*t*n,y:(1-t)*(1-t)*s+2*(1-t)*t*o+t*t*r}},D=({startPoint:t,controlPoint1:i,controlPoint2:s,endPoint:e,numberOfPointsToGenerate:o})=>{let n=[],r=o||50;for(let o=0;o<=r;o++){let a=null;a=s?S(o/r,t.x,t.y,i.x,i.y,s.x,s.y,e.x,e.y):R(o/r,t.x,t.y,i.x,i.y,e.x,e.y),n.push(a)}return n},O=t=>{let i=[];for(let s=1;s<t.length;s++){const e=t[s];if(e.x===t[s-1].x){const o=(e.y-t[s-1].y)/50;for(let n=0;n<50;n++)i.push({x:e.x,y:t[s-1].y+o*n})}else if(e.y===t[s-1].y){const o=(e.x-t[s-1].x)/50;for(let n=0;n<50;n++)i.push({x:t[s-1].x+o*n,y:e.y})}}return i.push({x:t[t.length-1].x,y:t[t.length-1].y}),i}}])},function(t,i){t.exports="data:image/svg+xml,%3Csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3E %3Cdefs%3E %3Cpattern id='smallGrid' width='8' height='8' patternUnits='userSpaceOnUse'%3E %3Cpath d='M 8 0 L 0 0 0 8' fill='none' stroke='gray' stroke-width='0.5'/%3E %3C/pattern%3E %3C/defs%3E %3Crect width='100%25' height='100%25' fill='url(%23smallGrid)' /%3E %3C/svg%3E"},function(t,i,s){"use strict";s.r(i),s.d(i,"Schema",(function(){return m})),s.d(i,"isMobile",(function(){return e.isMobile}));var e=s(0);class o extends e.CanvasElement{constructor({label:t,name:i,type:s,position:o,background:n,hoverBackground:r,connectionStyles:a,dimension:h,border:_,padding:l,font:d,reference:c,parent:m,index:f},g){super({name:i,position:o,dimension:h,padding:l},g),this._label=t,this._type=s||"",this._font=d instanceof e.Font?d:new e.Font(d),this._shape=new e.Rectangle({position:this._transform._position,dimension:this._transform._dimension,background:n,border:_}),this._backgroundColor=n?new e.Background(n):e.Background.TRANSPARENT,this._hoverBackground=r?new e.Background(r):e.Background.TRANSPARENT,this._connection=void 0,this._connectionStyles=a,this._parent=m,this._reference=c,g._ctx.save(),g._ctx.font=this._font.font2Canvas,this.typeWidth=g._ctx.measureText(this._type).width,g._ctx.restore(),this.fieldNameYPosition=this._transform._position.y+this._font._dimensions.height/5,this.fieldTypeXPosition=this._transform._position.x+this._transform._dimension.width-this.typeWidth-this._padding._right-this._parent._scrollBarWidth,this._index=f,this._fontIndexYPosition=this._index*this._font._dimensions.height,this._draw=this._transform._position.y>=this._parent.scrollableAreaY1Position-10&&this._transform._position.y<=this._parent.scrollableAreaY2Position-15,this.on("mousedown",()=>{this._connection&&this._connection.changeColorsAlpha(1)}),this.on("wheel",t=>{this.position={x:this._parent.scrollableAreaX1Position,y:t+this._fontIndexYPosition},this.fieldNameYPosition=this._transform._position.y+this._font._dimensions.height/5,this.fieldTypeXPosition=this._transform._position.x+this._transform._dimension.width-this.typeWidth-this._padding._right-this._parent._scrollBarWidth,this._draw=this._transform._position.y>=this._parent.scrollableAreaY1Position-10&&this._transform._position.y<=this._parent.scrollableAreaY2Position-15,this.setConnectionPoints(),this._connection&&this._connection.updatePath()}),this.on("mousedrag",({deltaX:t,deltaY:i})=>{this.position={x:this._transform._position.x+t,y:this._transform._position.y+i},this.fieldNameYPosition=this._transform._position.y+this._font._dimensions.height/5,this.fieldTypeXPosition=this._transform._position.x+this._transform._dimension.width-this.typeWidth-this._padding._right-this._parent._scrollBarWidth,this._connection&&this._connection.updatePath()}),this.on("mousemove",({x:t,y:i})=>{this._draw&&this._reactToIoEvents&&(this.contains({x:t,y:i})?this._shape._background.color=this._hoverBackground._color.rgba:this._shape._background.color=this._backgroundColor._color.rgba)}),this.on("mouseleave",t=>{this._draw&&this._reactToIoEvents&&(this._shape._background.color=this._backgroundColor._color.rgba),this._connection&&this._connection.changeColorsAlpha(.2)})}draw(t){this._draw&&(t.save(),this._shape.draw(t),t.font=this._font.font2Canvas,t.textBaseline="top",t.fillStyle=this._font._color.hex,this.typeWidth=t.measureText(this._type).width,t.fillText(this._label,this._transform._position.x,this.fieldNameYPosition),t.fillText(this._type,this.fieldTypeXPosition,this.fieldNameYPosition),t.restore())}get connectionPoints(){const t=this._transform._dimension.height/2;return{right:{name:"right",x:this._parent._transform._position.x+this._parent._transform._dimension.width,y:this._transform._position.y+t},left:{name:"left",x:this._parent._transform._position.x,y:this._transform._position.y+t}}}addConnection(t){this._connection=t,this.setConnectionPoints()}setConnectionPoints(){this._connection&&(this._draw?this._connection._to=this:this._connection._to=this._parent._footer)}}class n extends e.CanvasElement{constructor({name:t,src:i,position:s,padding:o,dimension:n,background:r,border:a,parent:h}){super({name:t,position:s,padding:o,dimension:n,parent:h}),this._draw=!1,this._image=new Image,this._image.src=i,this._image.addEventListener("load",()=>{this._draw=!0}),this._shape=new e.Rectangle({position:this._transform._position,dimension:this._transform._dimension,background:r,border:a}),this.on("mousedrag",({deltaX:t,deltaY:i})=>{this.position={x:this._transform._position.x+t,y:this._transform._position.y+i}})}draw(t){this._draw&&(t.save(),this._shape.draw(t),t.drawImage(this._image,this._transform._position.x,this._transform._position.y,this._transform._dimension.width,this._transform._dimension.height),t.restore())}}class r extends e.CanvasElement{constructor({title:t,icon:i,font:s,position:o,dimension:r,background:a,shadow:h,border:_,padding:l,parent:d},c){super({name:"header_"+t,position:o,dimension:r,padding:l,parent:d},c),this._title=t,this._font=s?new e.Font(s):e.Font.FONT,this._shape=new e.Rectangle({position:this._transform._position,dimension:this._transform._dimension,shadow:h,border:_,background:a}),i&&(this._icon=new n({name:i.name,src:i.src,parent:this,position:{x:this._transform._position.x+i.padding.left,y:this._transform._position.y+i.padding.top},dimension:i.dimension||{width:25,height:25},padding:i.padding,background:i.background,padding:i.padding,border:i.border})),this._connection=void 0,this.on("mousedrag",({deltaX:t,deltaY:i})=>{this.position={x:this._transform._position.x+t,y:this._transform._position.y+i},this._icon.emit("mousedrag",{deltaX:t,deltaY:i})})}draw(t){this._shape.draw(t),t.save(),t.font=this._font.font2Canvas,t.textBaseline="top",t.fillStyle=this._font._color.hex,t.fillText(this._title,this._shape._transform._position.x+this._padding._left+this._icon._transform._dimension.width+this._icon._padding._right,this._shape._transform._position.y+this._padding._top),t.restore(),this._icon&&this._icon.draw(t)}get connectionPoints(){const t=this._transform._dimension.height/2,i=this._transform._dimension.width/2;return{right:{name:"right",x:this._transform._position.x+this._transform._dimension.width,y:this._transform._position.y+t},left:{name:"left",x:this._transform._position.x,y:this._transform._position.y+t},middle:{name:"middle",x:this._transform._position.x+i,y:this._transform._position.y}}}}class a extends e.CanvasElement{constructor({name:t,position:i,dimension:s,background:o,shadow:n,border:r,padding:a,parent:h},_){super({name:"footer_"+t,position:i,dimension:s,padding:a,parent:h},_),this._shape=new e.Rectangle({position:this._transform._position,dimension:this._transform._dimension,shadow:n,border:r,background:o}),this._connection=void 0,this.on("mousedrag",({deltaX:t,deltaY:i})=>{this.position={x:this._transform._position.x+t,y:this._transform._position.y+i}})}draw(t){t.save(),this._shape.draw(t),t.restore()}get connectionPoints(){const t=this._transform._dimension.height/2,i=this._transform._dimension.width/2;return{right:{name:"right",x:this._transform._position.x+this._transform._dimension.width,y:this._transform._position.y+t},left:{name:"left",x:this._transform._position.x,y:this._transform._position.y+t},middle:{name:"middle",x:this._transform._position.x+i,y:this._transform._position.y+this._transform._dimension.height}}}}class h{constructor({position:t,dimension:i,color:s}){this._transform=new e.Transform({position:t,dimension:i}),this._color=new e.Color(s)}draw(t){t.save(),t.translate(this._transform._position.x,this._transform._position.y),t.rotate(this._transform._rotation.angle),t.translate(-this._transform._position.x,-this._transform._position.y),t.strokeStyle=this._color.rgba,t.lineWidth=5,t.lineCap="round",t.fillStyle="white",t.beginPath(),t.arc(this._transform._position.x-5,this._transform._position.y,5,0,2*Math.PI),t.closePath(),t.stroke(),t.fill(),t.strokeStyle=this._color.rgba,t.lineWidth=3,t.beginPath(),t.moveTo(this._transform._position.x+2,this._transform._position.y),t.lineTo(this._transform._position.x+14,this._transform._position.y),t.moveTo(this._transform._position.x+2,this._transform._position.y),t.lineTo(this._transform._position.x+14,this._transform._position.y+8),t.moveTo(this._transform._position.x+2,this._transform._position.y),t.lineTo(this._transform._position.x+14,this._transform._position.y-8),t.stroke(),t.restore()}}class _ extends e.CanvasElement{static get PADDING(){return 15}constructor({name:t,from:i,to:s,line:o,connector:n,padding:r,isEditable:a},l){super({name:t},l),this._z=0,this._from=i,this._to=s,this._line=new e.Line(o),n.position=s.position,this._connector=new h(n),this._isEditable=a,this._padding=r||_.PADDING,this._path=[],this._reactToIoEvents=!1}draw(t){if(this._path.length>0){t.save(),t.lineWidth=this._line._weight,t.strokeStyle=this._line._color.rgba,this._line._dashed&&t.setLineDash(this._line._dashed),t.lineWidth=this._line._weight,t.lineCap="square",t.beginPath();const i=this._path[0];if(t.moveTo(i.x,i.y),this._line&&this._line._enableBezierCurves){const i=this._path[1],s=this._path[2],e=this._path[3];t.bezierCurveTo(i.x,i.y,s.x,s.y,e.x,e.y)}else for(let i=1;i<this._path.length;i++){const s=this._path[i];t.lineTo(s.x,s.y)}t.stroke(),t.closePath(),t.restore();const s=this._path[this._path.length-1],e=this._path[this._path.length-2],o=s.x-e.x,n=s.y-e.y;this._connector._transform._rotation._angle=Math.atan2(n,o),this._connector._transform.position=s,this._connector.draw(t)}}updatePath(){const t=this._getConnectionPoints(),i=t.origin,s=t.destination;let e=Math.abs(s.x-i.x)/2,o=Math.abs(s.y-i.y)/2,n=[];if(this._from._parent._name===this._to._parent._name)n.push({x:i.x,y:i.y},{x:i.x+25,y:i.y},{x:s.x+25+this._padding,y:s.y},{x:s.x+this._padding,y:s.y});else if(i.name!==s.name){let t="right"===i.name?1:-1;n.push({x:i.x,y:i.y},{x:i.x+e*t,y:i.y},{x:s.x-e*t-this._padding*t,y:s.y},{x:s.x-this._padding*t,y:s.y})}else if("middle"===i.name&&"middle"===s.name)n.push({x:i.x,y:i.y},{x:i.x,y:i.y-o},{x:s.x,y:s.y+o+this._padding},{x:s.x,y:s.y+this._padding});else{const t="right"===i.name?1:-1;n.push({x:i.x,y:i.y},{x:i.x+25+e*t,y:i.y},{x:s.x+25+e*t,y:s.y},{x:s.x+this._padding,y:s.y})}this._path=n}changeColorsAlpha(t){this._line._color._alpha=t,this._connector._color._alpha=t}_getConnectionPoints(){let t={};const i=this._from._transform._position.x,s=i+this._from._transform._dimension.width,e=this._to._transform._position.x,n=e+this._to._transform._dimension.width,h=this._from.connectionPoints,_=this._to.connectionPoints;if(this._to._parent._name===this._from._parent._name)t={origin:h.right,destination:_.right};else if(this._to instanceof o&&this._from instanceof r||this._from instanceof o&&this._to instanceof a){let i=1/0;for(const[s,e]of Object.entries(h))for(const[o,n]of Object.entries(_)){if("middle"===s||"middle"===o)continue;const r=Math.abs(e.x-n.x);r<i&&(i=r,t={origin:e,destination:n})}}else{if(i>=e&&i<=n||s>=e&&s<=n)t={origin:h.middle,destination:_.middle};else{t=h.middle.x-_.middle.x>0?{origin:h.left,destination:_.right}:{origin:h.right,destination:_.left}}}return t}}class l extends e.CanvasElement{constructor({name:t,label:i,icon:s,font:n,fields:h,position:_,dimension:l,isDraggable:d,background:c,shadow:m,border:f,header:g,footer:p,padding:u},b){super({name:t,position:_,dimension:l,padding:u},b),this._z=1,this._label=i,this._font=n?new e.Font(n):e.Font.ARIAL,this._isDraggable=d||!1,this._shape=new e.Rectangle({position:this._transform._position,dimension:this._transform._dimension,border:f,background:c}),this._header=new r({title:i,font:n,icon:s,parent:this,position:this._transform._position,dimension:{width:this._transform._dimension.width,height:35},padding:g&&g.padding?g.padding:u,background:g&&g.background?g.background:c,border:g&&g.border?g.border:f},b),this._footer=new a({name:i,font:n,parent:this,position:{x:this._transform._position.x,y:this._transform._position.y+this._transform._dimension.height-35},dimension:{width:this._transform._dimension.width,height:35},padding:p&&p.padding?p.padding:u,background:p&&p.background?p.background:c,border:p&&p.border?p.border:f,shadow:m},b),this._showScrollBar=!1,this._scrollBarWidth=10,this._scrollPosition=0,this._scrollBarColor="rgba(0,0,0,0.2)",this._scrollBar=new Path2D,this.scrollableAreaWdith=this._shape._transform._dimension.width-2*this._padding._right,this.scrollableAreaX1Position=this._shape._transform._position.x+this._padding._left,this.scrollableAreaX2Position=this._shape._transform._position.x+this._padding._left+this.scrollableAreaWdith,this.scrollableAreaY1Position=this._shape._transform._position.y+this._header._transform._dimension.height+10,this.scrollableAreaY2Position=this._shape._transform._position.y+this._shape._transform._dimension.height-this._footer._transform._dimension.height-10,this._fields=[];for(let t=0;h&&t<h.length;t++){const i=h[t],s=i.font?new e.Font(i.font):e.Font.ARIAL,n=new o({label:i.label,name:i.name,parent:this,reference:i.reference,position:{x:this.scrollableAreaX1Position,y:this.scrollableAreaY1Position+s._dimensions.height*t},dimension:{width:this.scrollableAreaWdith-this._scrollBarWidth,height:s._dimensions.height},font:i.font,border:i.border,type:i.type,background:i.background,hoverBackground:i.hoverBackground,padding:i.padding,connectionStyles:i.connection,index:t},b);this._fields.push(n)}this._connections=[],this.clipAreaHeight=this._shape._transform._dimension.height-this._header._transform._dimension.height-this._footer._transform._dimension.height-20,this.scrollableAreaHeight=0!=this._fields.length?this._fields.length*this._fields[0]._font._dimensions.height:0,this.hasScroolBar=this.scrollableAreaHeight>this.clipAreaHeight,this.scrollbarX1Position=this.scrollableAreaX2Position-this._scrollBarWidth,this.percentOfVisibleFields=this.clipAreaHeight/this._fields[0]._font._dimensions.height/this._fields.length,this.scrollbarSize=parseInt(this.clipAreaHeight*this.percentOfVisibleFields).toFixed(2),this.initialFieldYPosition=this.scrollableAreaY1Position,this.on("mousedown",()=>{this._scrollBarIsBeingHovered?this._scrollBarIsSelected=!0:(this._canvas._canvasElementsManager.moveCanvasElementToLayer(this,2),this._connections.forEach(t=>{t&&t.changeColorsAlpha(1)}),this._fields.forEach(t=>t.emit("mousedown")))}),this.on("click",()=>{this._canvas._canvasElementsManager.moveCanvasElementToLayer(this,2)}),this.on("mousedrag",({deltaX:t,deltaY:i})=>{this.position={x:this._transform._position.x+t,y:this._transform._position.y+i},this._calculateScrollbarProperties(),this._header.emit("mousedrag",{deltaX:t,deltaY:i}),this._footer.emit("mousedrag",{deltaX:t,deltaY:i}),this._fields.forEach(s=>s.emit("mousedrag",{deltaX:t,deltaY:i})),this.initialFieldYPosition=this.scrollableAreaY1Position,this._connections.forEach(t=>{t.updatePath()})}),this.on("mouseup",t=>{this._scrollBarIsSelected=!1}),this.on("wheel",t=>{if(this.hasScroolBar){const i=Math.sign(t.deltaY),s=this.initialFieldYPosition+this.scrollableAreaHeight>this.scrollableAreaY2Position,e=this.initialFieldYPosition<this.scrollableAreaY1Position;(s&&i>0||e&&i<0)&&(this._scrollPosition-=5*i,this.initialFieldYPosition=this.scrollableAreaY1Position+this._scrollPosition,this._fields.forEach(t=>t.emit("wheel",this.initialFieldYPosition)))}}),this.on("mousemove",({x:t,y:i})=>{this._fields.forEach(s=>{s.emit("mousemove",{x:t,y:i})}),this._canvas._ctx.isPointInPath(this._scrollBar,t,i,"nonzero")?(this._scrollBarIsBeingHovered=!0,this._scrollBarColor="rgba(0,0,0,0.3)"):(this._scrollBarIsBeingHovered=!1,this._scrollBarColor="rgba(0,0,0,0.2)")}),this.on("mouseenter",t=>{this._showScrollBar=!0}),this.on("mouseleave",t=>{this._showScrollBar=!1,this._scrollBarIsBeingHovered=!1,this._fields.forEach(t=>{t.emit("mouseleave")}),this._connections.forEach(t=>{t&&t.changeColorsAlpha(.2)})}),this.on("select",()=>{this._selected=!0}),this.on("deselect",()=>{this._selected=!1})}draw(t){this._shape.draw(t),this._header.draw(t),t.save(),t.beginPath(),t.rect(this.scrollableAreaX1Position,this.scrollableAreaY1Position,this.scrollableAreaWdith,this.clipAreaHeight),t.clip(),this._fields.forEach(i=>{i.draw(t)}),t.restore(),this.hasScroolBar&&this._showScrollBar&&(t.save(),t.fillStyle="rgba(0,0,0,0.1)",t.beginPath(),t.rect(this.scrollbarX1Position,this.scrollableAreaY1Position,this._scrollBarWidth,this.clipAreaHeight),t.fill(),t.fillStyle=this._scrollBarColor,t.beginPath(),this._scrollBar=new Path2D,this._scrollBar.rect(this.scrollbarX1Position,this.scrollableAreaY1Position-this._scrollPosition*this.percentOfVisibleFields,this._scrollBarWidth,this.scrollbarSize),t.fill(this._scrollBar),t.restore()),this._footer.draw(t),this._selected&&(t.save(),t.lineWidth=3,t.strokeStyle="rgb(255,0,0)",t.strokeRect(this._transform._position.x,this._transform._position.y,this._transform._dimension.width,this._transform._dimension.height),t.restore())}addField(t){const i=t.font?new e.Font(t.font):e.Font.ARIAL,s=new o({label:t.label,name:t.name,parent:this,reference:t.reference,position:{x:this._transform._position.x,y:this._transform._position.y+i._dimensions.height*this._fields.length},dimension:{width:this.scrollableAreaWdith-this._scrollBarWidth,height:i._dimensions.height},font:i,border:t.border,padding:t.padding||{left:15,top:0,right:0,bottom:0},type:t.type,index:this._fields.length},this._canvas);this._fields.push(s),t.reference&&this.addConnectionToField(s,t.connection),this._calculateScrollbarProperties()}getFieldByName(t){return this._fields.find(i=>i._name===t)}addConnectionToField(t,i){const s=this._canvas._canvasElementsManager.getCanvasElementByName(t._reference);if(s){const e={name:`${this._name}-${t.name}-${s._name}`,isEditable:!1,connector:i.connector,line:i.line,to:t,from:s._header},o=new _(e,this._canvas);s._connections.push(o),t.addConnection(o),this._canvas._canvasElementsManager.addCanvasElement(o)}}_calculateScrollbarProperties(){this.scrollableAreaWdith=this._shape._transform._dimension.width-2*this._padding._right,this.scrollableAreaX1Position=this._shape._transform._position.x+this._padding._left,this.scrollableAreaX2Position=this._shape._transform._position.x+this._padding._left+this.scrollableAreaWdith,this.scrollableAreaY1Position=this._shape._transform._position.y+this._header._transform._dimension.height+10,this.scrollableAreaY2Position=this._shape._transform._position.y+this._shape._transform._dimension.height-this._footer._transform._dimension.height-10,this.clipAreaHeight=this._shape._transform._dimension.height-this._header._transform._dimension.height-this._footer._transform._dimension.height-20,this.scrollableAreaHeight=this._fields.length*this._fields[0]._font._dimensions.height,this.hasScroolBar=this.scrollableAreaHeight>this.clipAreaHeight,this.scrollbarX1Position=this.scrollableAreaX2Position-this._scrollBarWidth,this.percentOfVisibleFields=this.clipAreaHeight/this._fields[0]._font._dimensions.height/this._fields.length,this.scrollbarSize=parseInt(this.clipAreaHeight*this.percentOfVisibleFields).toFixed(2)}}var d=s(1),c=s.n(d);class m{constructor({canvas:t,options:i,data:s}){i.backgroundImage=i.backgroundImage||`url('${c.a}')`,this._canvas=new e.Canvas({canvas:t,options:i}),this.data=s}getTableByName(t){const i=this._canvas.canvasElementsManager.getCanvasElementByName(t);if(i)return i;throw new Error(`Table ${t} doesn't exist.`)}addTable(t){const i=new l(t,this._canvas);this._canvas.canvasElementsManager.addCanvasElement(i);const s=this._canvas.canvasElementsManager.getCanvasElementsInLayer(1);for(let t of s)t._fields.forEach(i=>{i._reference&&t.addConnectionToField(i)})}removeTableByName(t){const i=this._canvas.canvasElementsManager.getCanvasElementByName(t);this._canvas.canvasElementsManager.removeCanvasElementByName(t);const s=this._canvas.canvasElementsManager.getCanvasElementsInLayer(0);for(let t of s)t._to._parent._name!==i._name&&t._from._parent._name!=i._name||this._canvas.canvasElementsManager.removeCanvasElementByName(t._name)}addFieldToTable(t,i){this.getTableByName(i).addField(t)}getFieldByNameFromTable(t,i){return this.getTableByName(i).getFieldByName(t)}set data(t){for(let[i,s]of Object.entries(t)){const t=new l(s,this._canvas);this._canvas._canvasElementsManager.addCanvasElement(t)}const i=this._canvas._canvasElementsManager.getCanvasElementsInLayer(1);for(let t of i)t._fields.forEach(i=>{i._reference&&t.addConnectionToField(i,i._connectionStyles)});this._canvas.draw()}get data(){let t={tables:[]};const i=this._canvas._canvasElementsManager.getCanvasElementsInLayer(1);for(let s of i){let i={name:s._name,label:s._label,position:s._transform._position,dimension:{width:s._transform._dimension.width,height:s._transform._dimension.height},icon:s._header._icon._name,fields:[]};s._fields.forEach(t=>{i.fields.push({name:t._name,label:t._label,reference:t._reference})}),t.tables.push(i)}return t}on(t,i){"onkeypress"===t||"onkeyup"===t||"onkeydown"===t?window[t]=i:this._canvas._el.addEventListener(t,i)}saveAsImage(t){this.canvas.saveAsImage(t)}}}])}));